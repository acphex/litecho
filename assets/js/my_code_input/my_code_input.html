<html>
<head>
    <!-- Disable browser caching of dialog window -->
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style type='text/css'>
    body {
        font-family: sans-serif;
        background-color: #F1F1F1;
        color: #222;
    }
    .codeArea {
        margin: 10px auto;
        text-align: center;
    }
	.codetextarea{
		width:100%;
		height:300px;
		border:1px solid #ddd;
		padding:15px;
		margin-top:10px;
	}
	.codesubmit{
		width:50%;
		height:40px;
		background-color:#5bc0de;
		color:#fff;
		border-radius:2px;
		border:1px solid #46b8da;
		cursor:pointer;	
	}
    </style>
    <script>
    function htmlEntities(str) {
        return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
    }
 
    function InsertValue() {
		var myDate=new Date();
		var myDate=myDate.getTime();
        var codeNode = document.getElementById('code')
        var code = htmlEntities(codeNode.value);
        if(code == '') {codeNode.focus(); return;}
		var codehtml = '<div class="clipboard-wrap"><button class="btn" data-clipboard-action="copy" data-clipboard-target="#code_'+myDate+'">Copy</button><pre class="prettyprint linenums" id="code_'+myDate+'">'+code+'</pre></div><p></p>';
        window.parent.tinyMCE.activeEditor.execCommand('mceInsertContent', 0, codehtml); //获取内容并插入到编辑器
        window.parent.tinyMCE.activeEditor.windowManager.close(); //关闭对话框
    }
    </script>
</head>
<body>
    <form onsubmit="InsertValue();return false;">
        <div class="codeArea">
			<textarea class="codetextarea" id="code"></textarea>
            <p><input class="codesubmit" type="submit" value="确定"></p>
        </div>     
    </form>
</body>
</html>